<tool id="clean_dante_ltr" name="DANTE_LTR transposamble elements filtering" version="0.1.5" python_template_version="3.5">
    <requirements>

        <requirement type="package">r-optparse</requirement>
        <requirement type="package">blast</requirement>
        <requirement type="package">bioconductor-bsgenome</requirement>
        <requirement type="package">bioconductor-biostrings</requirement>
        <requirement type="package">bioconductor-rtracklayer</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
        Rscript ${__tool_directory__}/clean_ltr.R --gff3 '$dante_ltr' --reference_sequence '$reference' --output output --cpu 32
        &&
        mv output_clean.gff3 $dante_ltr_clean
        &&
        mv output_RM_lib_non_redundant.fasta $rm_lib
        &&
        mv output_RM_lib_full_TE.fasta $te_full
        &&
        mv output_RM_lib_5LTR.fasta $ltr5
        &&
        mv output_RM_lib_3LTR.fasta $ltr3
        &&
        mv output_summary.pdf $summary

    ]]></command>
    <inputs>
        <param type="data" name="dante_ltr" format="gff3" />
        <param type="data" name="reference" format="fasta" />
    </inputs>
    <outputs>
        <data name="dante_ltr_clean" format="gff3" label="Annotation of validated LTR transposable
        elements based on annotation $dante_ltr.hid and reference $reference.hid"/>
        <data name="rm_lib" format="fasta" label="Non-redundant library of LTR transposable
        elements based on annotation $dante_ltr.hid and reference $reference.hid"/>

        <data name="te_full" format="fasta" label="Full length LTR transposable
        elements based on annotation $dante_ltr.hid and reference $reference.hid"/>

        <data name="ltr5" format="fasta" label="5'LTR of transposable
        elements based on annotation $dante_ltr.hid and reference $reference.hid"/>

        <data name="ltr3" format="fasta" label="3'LTR of transposable
        elements based on annotation $dante_ltr.hid and reference $reference.hid"/>

        <data name="summary" format="pdf" label="Summary of TE and LTR lenghts based on
         $dante_ltr.hid and reference $reference.hid"/>

    </outputs>
    <help><![CDATA[
        This tool takes output from DANTE_LTR search identifies good quality transposable elements.
         Good quality TE are considered those which does not have any cross-similarity between distinct lineages.
         Output from this tool is a annotation in GFF3 format and
         non-redundant library of elements for custom RepeatMasker search.

    ]]></help>
</tool>